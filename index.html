<!DOCTYPE html>
<html lang="en">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta charset="utf-8" />
	<link rel="icon" href="https://open-innovations.org/resources/images/logos/oi-square.svg" />
	<title>Open Innovations Hexmap Library</title>
	<script src="dist/oi.hexmap.js"></script>
	<script src="resources/highlight.pack.js"></script>
	<link rel="StyleSheet" href="resources/highlight.css" type="text/css" />
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@OpenInnovates">
	<meta name="twitter:url" property="og:url" content="https://open-innovations.github.io/oi.hexmap.js/">
	<meta name="twitter:title" property="og:title" content="Hexmap Library">
	<meta name="twitter:description" property="og:description" content="Display interactive hex layouts (cartograms) in HexJSON.">
	<meta name="description" content="Display interactive hex layouts (cartograms) in HexJSON.">
	<meta name="twitter:image" property="og:image" content="https://open-innovations.org/resources/images/logos/oi-square.png">
	<style>
	/*! minireset.css v0.0.6 | MIT License | github.com/jgthms/minireset.css */html,body,p,ol,ul,li,dl,dt,dd,blockquote,figure,fieldset,legend,textarea,pre,iframe,hr,h1,h2,h3,h4,h5,h6{margin:0;padding:0}h1,h2,h3,h4,h5,h6{font-size:100%;font-weight:normal}ul{list-style:none}button,input,select{margin:0}html{box-sizing:border-box}*,*::before,*::after{box-sizing:inherit}img,video{height:auto;max-width:100%}iframe{border:0}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}

	@font-face {
		font-family: 'Poppins';
		font-style: italic;
		font-weight: 600;
		font-display: swap;
		src: url(https://open-innovations.org/resources/fonts/Poppins/pxiDyp8kv8JHgFVrJJLmr19VFteOcEg.woff2) format('woff2');
		unicode-range: U+0900-097F, U+1CD0-1CF6, U+1CF8-1CF9, U+200C-200D, U+20A8, U+20B9, U+25CC, U+A830-A839, U+A8E0-A8FB;
	}
	@font-face {
		font-family: 'Poppins';
		font-style: italic;
		font-weight: 600;
		font-display: swap;
		src: url(https://open-innovations.org/resources/fonts/Poppins/pxiDyp8kv8JHgFVrJJLmr19VGdeOcEg.woff2) format('woff2');
		unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
	}
	@font-face {
		font-family: 'Poppins';
		font-style: italic;
		font-weight: 600;
		font-display: swap;
		src: url(https://open-innovations.org/resources/fonts/Poppins/pxiDyp8kv8JHgFVrJJLmr19VF9eO.woff2) format('woff2');
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}
	@font-face {
		font-family: 'Poppins';
		font-style: normal;
		font-weight: 600;
		font-display: swap;
		src: url(https://open-innovations.org/resources/fonts/Poppins/pxiByp8kv8JHgFVrLEj6Z11lFc-K.woff2) format('woff2');
		unicode-range: U+0900-097F, U+1CD0-1CF6, U+1CF8-1CF9, U+200C-200D, U+20A8, U+20B9, U+25CC, U+A830-A839, U+A8E0-A8FB;
	}
	@font-face {
		font-family: 'Poppins';
		font-style: normal;
		font-weight: 600;
		font-display: swap;
		src: url(https://open-innovations.org/resources/fonts/Poppins/pxiByp8kv8JHgFVrLEj6Z1JlFc-K.woff2) format('woff2');
		unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
	}
	@font-face {
		font-family: 'Poppins';
		font-style: normal;
		font-weight: 600;
		font-display: swap;
		src: url(https://open-innovations.org/resources/fonts/Poppins/pxiByp8kv8JHgFVrLEj6Z1xlFQ.woff2) format('woff2');
		unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
	}

	/* Main site styling */
	html, body {
		padding: 0;
		margin: 0;
		min-height: 100%!important;
		height: 100%!important;
		background-color: #ffffff;
		font-family: "Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;
		font-size: 16px;
		color: #333;
		line-height: 1.44em;
	}
	h1,h2,h3,h4 { font-family: Poppins; line-height: 1em; }
	h1 { font-size: 2em; margin-top: 0; }
	h2 { font-size: 1.7em; margin-top: 1.7647058823529411em; font-weight: 500; }
	h3 { font-size: 1.4em; margin-top: 1.428571em; }
	h4 { font-size: 1.2em; margin-bottom: 0.2em; }
	h1 + p, h2 + p, h3 + p { margin-top: 1em; }
	#main { background-color: #ffffff; color: #333333; }
	.holder { position: relative; width: 1080px; max-width: 100%; margin: auto; }
	.padded { padding: 1em; }
	h1:first-child, h2:first-child, h3:first-child { margin-top: 0; }
	footer { width: 100%; padding: 1em 1em 3em; }
	footer a, footer a:visited { color: inherit; }
	code, pre { font-family: monospace; color: #555555; background-color: #efefef; padding: 0.125em 0.25em; }
	button, .button { border: 0; font-size: 1em; background-color: #efefef; color: black; text-decoration: none!important; display: inline-block; padding: 0.5em 1em; cursor: pointer; vertical-align: top; line-height: 1.25em; }
	.prettyprint {
		background: #efefef;
		padding: 1em;
	}
	section.example {
		border-top: 1px solid #999;
		margin-top: 4em;
		padding-top: 4em;
	}
	h2 + *, h3 + * { margin-top: 1em; }
	h4 { margin-top: 2em; font-weight: bold; }
	p { margin-top: 1em; }
	p + div { margin-top: 2em; }
	section.example h2 + * { margin-top: 1em; }
	.howto { margin-top: 1em; }
	.b1-bg, footer { background: black; color: white; }
	.b6-bg { background: white; color: black; }
	#intro { text-align: center; padding: 1em; max-width: 720px; margin: 0 auto 1em; }
	figure figcaption {
		width: 70%;
		margin: 1em auto 0 auto;
		font-size: 0.8em;
		line-height: 1.2em;
		text-align: center;
		color: #999;
	}
	figure:hover figcaption { color: inherit; }
	ol { margin: 1rem 0 1rem 1.5rem; }
	</style>
</head>
<body class="b6-bg">

	<header>
		<div class="b1-bg padded">
			<div class="holder" style="text-align:center;">
				<a href="https://open-innovations.org/"><img src="https://open-innovations.org/resources/images/logos/oi-square.svg" width="100px" height="100px" style="margin-bottom:1em;" /></a>
				<h1>Hexmap Library</h1>
				<script>
				a = new OI.hexmap();
				document.querySelector('h1').innerHTML += ' v'+a.version+'';
				</script>
			</div>
		</div>
	</header>
	<div class="padded">
		<div class="holder">
			<p id="intro"><a href="dist/oi.hexmap.js">oi.hexmap.js</a> (24.6kB; <a href="dist/oi.hexmap.min.js">15.6kB minified</a>; 6kB minified+gzipped) is our small, standalone, Javascript library for making interactive hexmaps (cartograms). There are some <a href="#ex1">examples below</a>.</p>
			
			<p>This library assumes you have an existing hex layout as <a href="https://open-innovations.org/projects/hexmaps/hexjson">HexJSON</a> (e.g. <a href="https://github.com/odileeds/hexmaps/tree/gh-pages/maps">layouts we've made</a>) and the ability to add Javascript to a webpage. The library creates an SVG (scalable vector graphic) of hexes - which can be styled via CSS - and some basic event callbacks.</p>

			<style>
			#hero {
				width: 100%;
                margin-top: 1em;
				overflow: hidden;
			}
			</style>
			<div id="hero">
			</div>
			<script>
				var c = ["#2254F4","#178CFF","#00B6FF","#08DEF9","#1DD3A7","#0DBC37","#67E767","#722EA5","#E6007C","#EF3AAB","#D73058","#D60303","#FF6700","#F9BC26"];
				// Create a HexJSON to fill the space
				hexjson = {"layout":"odd-r","hexes":{}};
				for(q = 0; q<22; q++){
					for(r = 0; r<5;r++) hexjson.hexes[q+"-"+r] = {"n":q+","+r,"q":q,"r":r,"colour":c[Math.round(Math.random()*14)]};
				}
				hero = new OI.hexmap(document.getElementById('hero'),{
					"hexjson": hexjson,
					"size": 32	// Hard-code a size for the hexes
				});
			</script>

			<h4>Include the Javascript library</h4>
			<pre class="prettyprint lang-css hljs">
			&lt;script src="dist/oi.hexmap.js"&gt;&lt;/script&gt;
			</pre>
			
			<section class="example" id="ex1">
				<h2>A basic hexmap</h2>
				<p>Let's create a very basic hex map using a HexJSON layout. Everything happens in <code>OI.hexmap(el,attributes)</code> where <code>el</code> is the DOM element we are attaching the hex map to and <code>attributes</code> defines properties of the hex map. At a minimum, <code>attributes</code> should include <code>hexjson</code> which can either be inline HexJSON or a path to an external HexJSON file. In this example we will add the HexJSON inline.</p>
				<p>By default, the <code>&lt;title&gt;</code> of each hex (try hovering over them) uses the <code>n</code> or <code>name</code> property of the hex in the HexJSON.</p>
				<div class="example-code">
					<style>
					/* Define the size of the hexmap area */
					#hexmap1 { height: 300px; width: 100%; }
					</style>
					<div id="hexmap1"></div>
					<script>
					OI.ready(function(){
						// Attach our hexmap to <div id="hexmap1"></div>
						hex = new OI.hexmap(document.getElementById('hexmap1'),{
							// Define the HexJSON - https://open-innovations.org/projects/hexmaps/hexjson
							'hexjson':{
								"layout":"odd-r",
								"hexes": {
									"A":{"n":"0,1","q":0,"r":1},
									"B":{"n":"1,1","q":1,"r":1},
									"C":{"n":"2,1","q":2,"r":1},
									"D":{"n":"0,2","q":0,"r":2},
									"E":{"n":"1,2","q":1,"r":2},
									"F":{"n":"2,2","q":2,"r":2}
								}
							}
						});
					});
					</script>
				</div>
			</section>

			<section class="example" id="ex2">
				<h2>Styling hexes and labels</h2>
				<p>We will use the same hexmap but this time we add some extra properties to each item in the HexJSON. The <code>colour</code> property is used to colour each hex. We also turn on labels, make sure they are clipped to the hexagon, and customise the text of the label. The default label text is the value of <code>n</code> or <code>name</code> truncated to three characters but we can provide a <code>format</code> function to customise the content. In this example we build a more complex label using multiple <code>tspan</code> elements. We make use of CSS classes so that we can make some parts of the label only visible on hover. We can also scale the size of the hexagon on hover (the code adds the style <code>.hover</code> to the hexagon and label).</p>
				<div class="example-code">
					<style>
					#hexmap2 { height: 500px; width: 100%; animation-duration: 0.3s; }
					#hexmap2 .hex path { stroke: white; stroke-width: 2; transition: fill 0.3s ease-in, stroke 0.3s ease-in, stroke-width 0.3s ease-in; }
					/* Make the hexagon larger when hovered */
					#hexmap2 .hover path { stroke-width: 4px; transform: scale(1.75); stroke: black; }
					#hexmap2 .hex-label { font-size: 1rem; line-height:1.1em;}
					/* Set the on and off styles for the text labels */
					#hexmap2 .hex-label tspan.on { display: none; }
					#hexmap2 .hex-label tspan.off { display: block; }
					#hexmap2 .hex-label tspan.big { font-weight: bold; font-size: 1.2em; }
					#hexmap2 .hover .hex-label tspan.on { display: block; }
					#hexmap2 .hover .hex-label tspan.off { display: none; }
					</style>
					<figure>
						<div id="hexmap2"></div>
						<figcaption>Cartogram showing Leeds wards with colours assigned manually.</figcaption>
					</figure>
					<script>
					OI.ready(function(){
						hex = new OI.hexmap(document.getElementById('hexmap2'),{
							'grid': {'show':true},
							'label':{
								'show': true,	// Show a label
								'clip': true,	// Make sure the label is clipped to the hexagon
								// Define a function to format the hex labels
								// It is passed:
								//  * txt - a text string with the hex's name
								//  * attr - an object containing:
								//		* size - the size in pixels
								//		* font-size - the font size in pixels
								//		* x - the horizontal position in pixels
								//		* y - the vertical position in pixels
								//		* hex - the hexagon's HexJSON properties
								'format': function(txt,attr){
									tspans = '<tspan class="off">'+txt.substring(0,3)+'</tspan>';
									lines = txt.split(/ /);
									lines.push(attr.hex.pop.toLocaleString());
									var lineheight = attr['line-height']||(attr['font-size']*1.5);
									for(var i = 0; i < lines.length; i++){
										tspans += '<tspan class="on'+(i==lines.length-1 ? ' big':'')+'" y="'+((i-lines.length/2+0.5)*lineheight).toFixed(3)+'" x="0">'+lines[i]+'</tspan>';
									}
									return tspans;
								}
							},
							// The HexJSON layout
							'hexjson':{
								"layout":"odd-r",
								"hexes": {
									"E05001425":{"n":"Guiseley and Rawdon","q":-3,"r":3,"pop":18253,"colour":"rgb(247, 171, 45)"},
									"E05001437":{"n":"Otley and Yeadon","q":-2,"r":3,"pop":17616,"colour":"rgb(246, 166, 47)"},
									"E05001411":{"n":"Adel and Wharfedale","q":-1,"r":3,"pop":15919,"colour":"rgb(248, 186, 38)"},
									"E05001412":{"n":"Alwoodley","q":0,"r":3,"pop":17890,"colour":"rgb(245, 150, 55)"},
									"E05001426":{"n":"Harewood","q":1,"r":3,"pop":15194,"colour":"rgb(249, 188, 38)"},
									"E05001443":{"n":"Wetherby","q":2,"r":3,"pop":15753,"colour":"rgb(247, 172, 45)"},
									"E05001428":{"n":"Horsforth","q":-2,"r":2,"pop":17318,"colour":"rgb(247, 172, 45)"},
									"E05001442":{"n":"Weetwood","q":-1,"r":2,"pop":15777,"colour":"rgb(246, 160, 50)"},
									"E05001434":{"n":"Moortown","q":0,"r":2,"pop":17595,"colour":"rgb(246, 161, 50)"},
									"E05001440":{"n":"Roundhay","q":1,"r":2,"pop":17419,"colour":"rgb(247, 170, 45)"},
									"E05001418":{"n":"Calverley and Farsley","q":-4,"r":1,"pop":18009,"colour":"rgb(245, 150, 54)"},
									"E05001416":{"n":"Bramley and Stanningley","q":-3,"r":1,"pop":16582,"colour":"rgb(236, 61, 95)"},
									"E05001432":{"n":"Kirkstall","q":-2,"r":1,"pop":15547,"colour":"rgb(239, 91, 82)"},
									"E05001427":{"n":"Headingley and Hyde Park","q":-1,"r":1,"pop":19339,"colour":"rgb(230, 9, 119)"},
									"E05001419":{"n":"Chapel Allerton","q":0,"r":1,"pop":17792,"colour":"rgb(241, 117, 70)"},
									"E05001430":{"n":"Killingbeck and Seacroft","q":1,"r":1,"pop":16467,"colour":"rgb(233, 36, 107)"},
									"E05001438":{"n":"Pudsey","q":-3,"r":0,"pop":18485,"colour":"rgb(244, 139, 60)"},
									"E05001414":{"n":"Armley","q":-2,"r":0,"pop":16270,"colour":"rgb(235, 54, 99)"},
									"E05001429":{"n":"Little London and Woodhouse","q":-1,"r":0,"pop":14367,"colour":"rgb(230, 0, 124)"},
									"E05001424":{"n":"Gipton and Harehills","q":0,"r":0,"pop":16350,"colour":"rgb(235, 58, 97)"},
									"E05001421":{"n":"Cross Gates and Whinmoor","q":1,"r":0,"pop":17819,"colour":"rgb(239, 91, 81)"},
									"E05001422":{"n":"Farnley and Wortley","q":-3,"r":-1,"pop":17908,"colour":"rgb(237, 73, 90)"},
									"E05001415":{"n":"Beeston and Holbeck","q":-2,"r":-1,"pop":15203,"colour":"rgb(235, 54, 98)"},
									"E05001420":{"n":"Hunslet and Riverside","q":-1,"r":-1,"pop":17054,"colour":"rgb(236, 68, 92)"},
									"E05001417":{"n":"Burmantofts and Richmond Hill","q":0,"r":-1,"pop":15522,"colour":"rgb(235, 52, 100)"},
									"E05001441":{"n":"Temple Newsam","q":1,"r":-1,"pop":16437,"colour":"rgb(240, 106, 75)"},
									"E05001435":{"n":"Morley North","q":-2,"r":-2,"pop":17733,"colour":"rgb(241, 109, 73)"},
									"E05001433":{"n":"Middleton Park","q":-1,"r":-2,"pop":19135,"colour":"rgb(234, 44, 103)"},
									"E05001439":{"n":"Rothwell","q":0,"r":-2,"pop":15889,"colour":"rgb(243, 133, 62)"},
									"E05001423":{"n":"Garforth and Swillington","q":1,"r":-2,"pop":16260,"colour":"rgb(247, 170, 45)"},
									"E05001436":{"n":"Morley South","q":-2,"r":-3,"pop":16684,"colour":"rgb(239, 93, 81)"},
									"E05001413":{"n":"Ardsley and Robin Hood","q":-1,"r":-3,"pop":17443,"colour":"rgb(239, 97, 79)"},
									"E05001431":{"n":"Kippax and Methley","q":0,"r":-3,"pop":16355,"colour":"rgb(242, 118, 69)"}
								}
							}
						});
					});
					</script>
				</div>
			</section>

			<section class="example" id="ex3b">
				<h2>Using external HexJSON, adding tooltips, styling boundaries</h2>
				<p>This example loads in an external HexJSON file, and then colours the hexes depending on the data. To work out the colours we'll make a little helper function <code>ColourScale</code>.</p>
				<p>This example also styles the <code>boundaries</code> defined in the HexJSON by calling <code>this.updateBoundaries(fn)</code> with a function, <code>fn</code>, that has the line ID and line properties as input parameters. This allows us some flexibility in how different lines are styled.</p>
				<div class="example-code">
					<style>
					#hexmap3b { height: 800px; width: 100%; margin-top: 1em; position: relative; animation-duration: 0.3s; }
					#hexmap3b .hex path { stroke: black; stroke-width: 0; transition: fill 0.2s ease-in, stroke 0.2s ease-in, stroke-width 0.2s ease-in; }
					#hexmap3b .hover path { stroke-width: 4px; }
					@media only screen and (max-width: 700px) {
						/* Don't bother with labels if it is too small */
						#hexmap3b .hex text { display: none; }
					}
					#hexmap3b .tooltip { position: absolute; text-align: center; background: black; color: white; padding: 0.5rem; transform: translate3d(-50%,50%,0); transition: left 0.1s linear, top 0.1s linear; border-radius: 4px; }
					#hexmap3b .tooltip::after { content: ""; position: absolute; bottom: auto; width: 0; height: 0; border: 0.5em solid transparent; left: 50%; top: 0; transform: translate3d(-50%,-100%,0); border-bottom-color: black; }
					</style>
					<figure>
						<div id="hexmap3b"></div>
						<figcaption>Cartogram showing UK constituencies coloured by the number of signatures they received on House of Commons petitions during 2017-2019. Data from The House of Commons Library. Layout by Open Innovations and contributors.</figcaption>
					</figure>
					<script>
					OI.ready(function(){
						// Create the hexagon layout
						hex = new OI.hexmap(document.getElementById('hexmap3b'),{
							// The HexJSON layout
							'hexjson':'resources/uk-constituencies-2023.hexjson',
							// Once we've loaded the map the ready function is called
							'ready':function(){
								this.updateColours(function(r){
									return this.areas[r].data.colour;
								})
								// Update the line styles
								this.updateBoundaries(function(n,props){
									if(props.type=="country") return {'stroke':'white','stroke-width':3,'stroke-dasharray':'4 4','stroke-linecap':'round','opacity':0.9};
									if(props.type=="region") return {'stroke':'white','stroke-width':2,'stroke-dasharray':'4 4','stroke-linecap':'round','opacity':0.6};
								});
							}
						});

						// Make a tooltip
						hex.on('mouseover',function(e){
							var svg,tip,bb,bbo,hex;
							svg = e.data.hexmap.el;
							hex = e.target;
							// Get any existing tooltip for this hexmap
							tip = svg.querySelector('.tooltip');
							if(!tip){
								// Add a new tooltip
								tip = document.createElement('div');
								tip.classList.add('tooltip');
								svg.appendChild(tip);
							}
							// Update contents of tooltip
							tip.innerHTML = e.data.data.n+'<br />q,r: '+e.data.data.q+','+e.data.data.r+'<br />Region: '+e.data.data.region;
							// Update position of tooltip
							bb = hex.getBoundingClientRect();
							bbo = svg.getBoundingClientRect();
							tip.style.left = Math.round(bb.left + bb.width/2 - bbo.left + svg.scrollLeft)+'px';
							tip.style.top = Math.round(bb.top + bb.height/2 - bbo.top)+'px';
						});
					});
					</script>
				</div>
			</section>

			<section class="example" id="ex3">
				<h2>Using external data, adding tooltips, styling boundaries</h2>
				<p>This example loads in an external HexJSON file, loads in some external JSON data, and then colours the hexes depending on the data. To work out the colours we'll make a little helper function <code>ColourScale</code>.</p>
				<p>This example also styles the <code>boundaries</code> defined in the HexJSON by calling <code>this.updateBoundaries(fn)</code> with a function, <code>fn</code>, that has the line ID and line properties as input parameters. This allows us some flexibility in how different lines are styled.</p>
				<div class="example-code">
					<style>
					#hexmap3 { height: 800px; width: 100%; margin-top: 1em; position: relative; animation-duration: 0.3s; }
					#hexmap3 .hex path { stroke: black; stroke-width: 0; transition: fill 0.2s ease-in, stroke 0.2s ease-in, stroke-width 0.2s ease-in; }
					#hexmap3 .hover path { stroke-width: 4px; }
					@media only screen and (max-width: 700px) {
						/* Don't bother with labels if it is too small */
						#hexmap3 .hex-label { display: none; }
					}
					#hexmap3 .tooltip { position: absolute; text-align: center; background: black; color: white; padding: 0.5rem; transform: translate3d(-50%,50%,0); transition: left 0.1s linear, top 0.1s linear; border-radius: 4px; }
					#hexmap3 .tooltip::after { content: ""; position: absolute; bottom: auto; width: 0; height: 0; border: 0.5em solid transparent; left: 50%; top: 0; transform: translate3d(-50%,-100%,0); border-bottom-color: black; }
					</style>
					<figure>
						<div id="hexmap3"></div>
						<figcaption>Cartogram showing UK constituencies coloured by the number of signatures they received on House of Commons petitions during 2017-2019. Data from The House of Commons Library. Layout by Open Innovations and contributors.</figcaption>
					</figure>
					<script>
					OI.ready(function(){
						// Define a colour scale helper function
						function ColourScale(c){
							var s,n;
							s = c;
							n = s.length;
							// Get a colour given a value, and the range minimum/maximum
							this.getValue = function(v,min,max){
								var c,a,b;
								v = (v-min)/(max-min);
								if(v<0) return 'rgb('+s[0].rgb.join(',')+')';
								if(v>=1) return 'rgb('+s[n-1].rgb.join(',')+')';
								for(c = 0; c < n-1; c++){
									a = s[c];
									b = s[c+1];
									if(v >= a.v && v < b.v){
										pc = Math.min(1,(v - a.v)/(b.v-a.v));
										rgb = [Math.round(a.rgb[0] + (b.rgb[0]-a.rgb[0])*pc),Math.round(a.rgb[1] + (b.rgb[1]-a.rgb[1])*pc),Math.round(a.rgb[2] + (b.rgb[2]-a.rgb[2])*pc)];
										return 'rgb('+rgb.join(',')+')';
									}
								}
							};
							return this;
						}

						// Define the Viridis colour scale
						viridis = new ColourScale([{'rgb':[68,1,84],v:0},{'rgb':[72,35,116],'v':0.1},{'rgb':[64,67,135],'v':0.2},{'rgb':[52,94,141],'v':0.3},{'rgb':[41,120,142],'v':0.4},{'rgb':[32,143,140],'v':0.5},{'rgb':[34,167,132],'v':0.6},{'rgb':[66,190,113],'v':0.7},{'rgb':[121,209,81],'v':0.8},{'rgb':[186,222,39],'v':0.9},{'rgb':[253,231,36],'v':1}]);

						// Create the hexagon layout
						hex = new OI.hexmap(document.getElementById('hexmap3'),{
							'grid': {'show':true},
							// The HexJSON layout
							'hexjson':'resources/constituencies.hexjson',
							// Once we've loaded the map the ready function is called
							'ready':function(){
								var url = 'resources/2017-9.json';
								// Load the data
								fetch(url)
								.then(function(response){ return response.json(); })
								.then(function(data){
									// Process the data file to find the minimum and maximum
									var min = 1e100;
									var max = -1e100;
									for(var r in data){
										min = Math.min(data[r],min);
										max = Math.max(data[r],max);
									}
									this.data = data;
									
									// Update the hex colours
									this.updateColours(function(r){ return viridis.getValue(data[r],min,max); });
									
									// Update the line styles
									this.updateBoundaries(function(n,props){
										if(props.type=="country") return {'stroke':'white','stroke-width':3,'stroke-linecap':'round','opacity':0.9};
										if(props.type=="region") return {'stroke':'white','stroke-width':3,'stroke-linecap':'round','opacity':0.4};
									});
								}.bind(this)).catch(function(error){
									console.log(this,error);
									this.log('ERROR','Unable to load '+url);
								});
							}
						});

						// Make a tooltip
						hex.on('mouseover',function(e){
							var svg,tip,bb,bbo,hex;
							svg = e.data.hexmap.el;
							hex = e.target;
							// Get any existing tooltip for this hexmap
							tip = svg.querySelector('.tooltip');
							if(!tip){
								// Add a new tooltip
								tip = document.createElement('div');
								tip.classList.add('tooltip');
								svg.appendChild(tip);
							}
							// Update contents of tooltip
							tip.innerHTML = e.data.data.n+'<br />'+e.data.hexmap.data[e.data.region].toLocaleString()+' signatures<br />Coordinates: '+e.data.data.q+','+e.data.data.r+'<br />Region: '+e.data.data.a;
							// Update position of tooltip
							bb = hex.getBoundingClientRect();
							bbo = svg.getBoundingClientRect();
							tip.style.left = Math.round(bb.left + bb.width/2 - bbo.left + svg.scrollLeft)+'px';
							tip.style.top = Math.round(bb.top + bb.height/2 - bbo.top)+'px';
						});
					});
					</script>
				</div>
			</section>


			<section class="example" id="ex3c">
				
				<h2>Style boundaries</h2>
				<p>In this example we load in an external HexJSON, set the colours based on the <code>q</code> value, and add a tooltip.</p>
				<div class="example-code">
					<style>
					#hexmap3c { height: 800px; width: 100%; margin-top: 1em; position: relative; animation-duration: 0.3s; }
					#hexmap3c .hex path { stroke: black; stroke-width: 0; transition: fill 0.2s ease-in, stroke 0.2s ease-in, stroke-width 0.2s ease-in; }
					#hexmap3c .hover path { stroke-width: 4px; }
					@media only screen and (max-width: 700px) {
						/* Don't bother with labels if it is too small */
						#hexmap3c .hex .hex-label { display: none; }
					}
					#hexmap3c .tooltip { position: absolute; text-align: center; background: black; color: white; padding: 0.5rem; transform: translate3d(-50%,50%,0); transition: left 0.1s linear, top 0.1s linear; border-radius: 4px; }
					#hexmap3c .tooltip::after { content: ""; position: absolute; bottom: auto; width: 0; height: 0; border: 0.5em solid transparent; left: 50%; top: 0; transform: translate3d(-50%,-100%,0); border-bottom-color: black; }
					</style>
					<figure>
						<div id="hexmap3c"></div>
						<figcaption>Cartogram showing UK local authorities coloured by the number of signatures they received on House of Commons petitions during 2017-2019. Data from The House of Commons Library. Layout by Open Innovations and contributors.</figcaption>
					</figure>
					<script>
					OI.ready(function(){
						// Define a colour scale helper function
						function ColourScale(c){
							var s,n;
							s = c;
							n = s.length;
							// Get a colour given a value, and the range minimum/maximum
							this.getValue = function(v,min,max){
								var c,a,b;
								v = (v-min)/(max-min);
								if(v<0) return 'rgb('+s[0].rgb.join(',')+')';
								if(v>=1) return 'rgb('+s[n-1].rgb.join(',')+')';
								for(c = 0; c < n-1; c++){
									a = s[c];
									b = s[c+1];
									if(v >= a.v && v < b.v){
										pc = Math.min(1,(v - a.v)/(b.v-a.v));
										rgb = [Math.round(a.rgb[0] + (b.rgb[0]-a.rgb[0])*pc),Math.round(a.rgb[1] + (b.rgb[1]-a.rgb[1])*pc),Math.round(a.rgb[2] + (b.rgb[2]-a.rgb[2])*pc)];
										return 'rgb('+rgb.join(',')+')';
									}
								}
							};
							return this;
						}

						// Define the Viridis colour scale
						viridis = new ColourScale([{'rgb':[68,1,84],v:0},{'rgb':[72,35,116],'v':0.1},{'rgb':[64,67,135],'v':0.2},{'rgb':[52,94,141],'v':0.3},{'rgb':[41,120,142],'v':0.4},{'rgb':[32,143,140],'v':0.5},{'rgb':[34,167,132],'v':0.6},{'rgb':[66,190,113],'v':0.7},{'rgb':[121,209,81],'v':0.8},{'rgb':[186,222,39],'v':0.9},{'rgb':[253,231,36],'v':1}]);

						// Create the hexagon layout
						hex = new OI.hexmap(document.getElementById('hexmap3c'),{
							// The HexJSON layout
							'hexjson':'resources/uk-local-authority-districts-2023.hexjson',
							// Once we've loaded the map the ready function is called
							'ready':function(d){
								// Process the data to find the minimum and maximum
								var q,r,min = Infinity, max = -Infinity;
								for(r in this.areas){
									q = this.areas[r].data.q;
									min = Math.min(q,min);
									max = Math.max(q,max);
								}
								this.updateColours(function(r){
									return viridis.getValue(this.areas[r].data.q,min,max);
								})
								// Update the line styles
								this.updateBoundaries(function(n,props){
									if(props.type=="country") return {'stroke':'black','stroke-width':3,'stroke-linecap':'round','opacity':0.9};
								});
							}
						});

						// Make a tooltip
						hex.on('mouseover',function(e){
							var svg,tip,bb,bbo,hex;
							svg = e.data.hexmap.el;
							hex = e.target;
							// Get any existing tooltip for this hexmap
							tip = svg.querySelector('.tooltip');
							if(!tip){
								// Add a new tooltip
								tip = document.createElement('div');
								tip.classList.add('tooltip');
								svg.appendChild(tip);
							}
							// Update contents of tooltip
							tip.innerHTML = e.data.data.n+'<br />q,r: '+e.data.data.q+','+e.data.data.r+'<br />Region: '+e.data.data.region;
							// Update position of tooltip
							bb = hex.getBoundingClientRect();
							bbo = svg.getBoundingClientRect();
							tip.style.left = Math.round(bb.left + bb.width/2 - bbo.left + svg.scrollLeft)+'px';
							tip.style.top = Math.round(bb.top + bb.height/2 - bbo.top)+'px';
						});
					});
					</script>
				</div>
			</section>

			<section class="example" id="ex4">
				<h2>London 1895</h2>
				<p>Inspired by a <a href="https://open-innovations.org/blog/images/small/hexmap-inspiration.webp">hexagon map of London from 1895</a> released by the British Library.</p>
				<div class="example-code">
					<style>
					#ex4 figure { font-family: "Times New Roman", serif; background-color: #fdf4d6; padding: 2rem; position: relative; color: #656058; }
					#ex4 figcaption { margin-top: 2em; text-align: center; }
					#hexmap4 { border-radius: 100%; border: 4px solid #656058; padding:2em;aspect-ratio: 1 / 1; position: relative; margin: auto; }
					#hexmap4 tspan.name { font-family: "Arial Black","Copperplate Gothic Bold","Times New Roman", serif; }
					#hexmap4 .hex path { stroke: #656058; stroke-width: 3px; color: inherit; }
					#hexmap4 .hex-label .id, #hexmap4 .hex-label .name { font-weight: 700; fill: #656058; text-shadow: 3px 3px 2px #fdf4d6, -3px 3px 1px #fdf4d6, -3px -3px 1px #fdf4d6, 3px -3px 2px #fdf4d6; }
					#hexmap4 .hex .hex-label { stroke-width: 0; transform: scale(0.3); }
					#hexmap4 .hex.big .hex-label { transform: scale(0.6); }
					#hexmap4 .hex.hover .hex-label { transform: scale(0.4); }
					#hexmap4 .hex.big.hover .hex-label { transform: scale(0.9); }
					#hexmap4 .hex-label .id { font-size: 250%; font-family: "Times New Roman", serif; }
					#hexmap4 .hex-label .name { font-size: 1.3em; text-transform: uppercase; }
					#hexmap4 .hex.hover path { transform: scale(1.2); stroke-width: 4px; stroke: black; }
					#hexmap4 .hex.hover .id, #hexmap4 .hex.hover .name { text-shadow: none; fill: #fdf4d6; }
					#hexmap4 .data-layer .hex path { fill: #fdf4d6!important; }
					#hexmap4 .data-layer .hex.hover path { fill: #656058!important; }
					#hexmap4 .data-layer .vertical path { fill: url(#verticalHatch)!important; }
					#hexmap4 .data-layer .horizontal path { fill: url(#horizontalHatch)!important; }
					</style>
					<figure>
						<div id="hexmap4">
						</div>
						<figcaption>London indexed by 2-mile hexagons</figcaption>
					</figure>
					<script>
					OI.ready(function(){
						hex = new OI.hexmap(document.getElementById('hexmap4'),{
							// The HexJSON layout
							'hexjson': {
								"layout":"odd-q",
								"hexes": {
									"A":{"n":"1a","q":0,"r":3,"label":"Horn<br>sey","class":"horizontal"},
									"B":{"n":"2a","q":1,"r":2,"label":"Hack<br>ney","class":"horizontal"},
									"C":{"n":"3a","q":2,"r":2,"label":"Old<br>Ford","class":"horizontal"},
									"D":{"n":"4a","q":2,"r":1,"label":"Poplar","class":"horizontal"},
									"E":{"n":"5a","q":2,"r":0,"label":"Dept<br>ford","class":"horizontal"},
									"F":{"n":"6a","q":1,"r":-1,"label":"Peck<br>ham","class":"horizontal"},
									"G":{"n":"7a","q":0,"r":-1,"label":"Brix<br>ton","class":"horizontal"},
									"H":{"n":"8a","q":-1,"r":-1,"label":"Batter<br>sea","class":"horizontal"},
									"I":{"n":"9a","q":-2,"r":0,"label":"Chel<br>sea","class":"horizontal"},
									"J":{"n":"10a","q":-2,"r":1,"label":"Mary Le<br>Bone","class":"horizontal"},
									"K":{"n":"11a","q":-2,"r":2,"label":"S<sup>t</sup> John'<sup>s</sup><br />Wood","class":"horizontal"},
									"L":{"n":"12a","q":-1,"r":2,"label":"Kentish<br>Town","class":"horizontal"},
									"M":{"n":"1","q":0,"r":2,"label":"Isling·<br>ton","class":"vertical"},
									"N":{"n":"2","q":1,"r":1,"label":"Bethnal<br>Green","class":"vertical"},
									"O":{"n":"3","q":1,"r":0,"label":"South·<br>wark","class":"vertical"},
									"P":{"n":"4","q":0,"r":0,"label":"Kenning·<br>ton","class":"vertical"},
									"Q":{"n":"5","q":-1,"r":0,"label":"Westmin·<br>ster","class":"vertical"},
									"R":{"n":"6","q":-1,"r":1,"label":"St Pan·<br>cras","class":"vertical"},
									"S":{"n":"","q":0,"r":1,"label":"The<br><tspan class='capital'>City</tspan>","class":"big"}
								}
							},
							'patterns': [
								'<pattern id="verticalHatch" patternUnits="userSpaceOnUse" width="8" height="8"><path d="M0,0 l0,8 M0,4 l0,8" style="stroke:#656058;stroke-width:8;opacity:0.3;" /></pattern>',
								'<pattern id="horizontalHatch" patternUnits="userSpaceOnUse" width="8" height="8"><path d="M0,0 l8,0 M4,0 l8,0" style="stroke:#656058;stroke-width:8;opacity:0.3;" /></pattern>'
							],
							'label': {
								'show': true,
								'format': function(txt,attr){
									var tspans = '';
									lines = (txt) ? [txt] : [];
									lines = lines.concat(attr.hex.label.split(/<br ?\/?>/));
									for(var i = 0; i < lines.length; i++){
										tspans += '<tspan class="'+(txt && i==0 ? 'id':'name')+'" y="'+((i-lines.length/2+0.5)*(attr['font-size']*1.5)).toFixed(3)+'" x="0">'+lines[i].replace(/<sup>/g,'<tspan dy="-4" font-size="60%">').replace(/<\/sup>/g,'</tspan><tspan dy="4"> </tspan>')+'</tspan>';
									}
									return tspans;
								}
							},
							// Once we've loaded the map the ready function is called
							'ready':function(){
							}
						});
					});
					</script>
				</div>
			</section>

			<section class="example" id="ex5">
				<h2>Add an image to a hex</h2>
				<p>The hex maps are built from SVG. This library doesn't really support adding images to hexes. However, you can apply background images to the container with CSS (<code>background-image</code>) or you can apply a <code>&lt;pattern&gt;</code> to a particular hexagon.</p>
				<div class="example-code">
					<style>
					/* Apply a background image to the container */
					#hexmap5 { aspect-ratio: 1 / 1; position: relative; margin: auto; padding: 2rem; background-image:url("data:image/svg+xml,<svg id=\'memphis-2\' width=\'100%\' height=\'100%\' xmlns=\'http://www.w3.org/2000/svg\'><defs><pattern id=\'memphis-2-pattern\' patternUnits=\'userSpaceOnUse\' width=\'100\' height=\'100\' patternTransform=\'scale(2) rotate(0)\'><rect x=\'0\' y=\'0\' width=\'100%\' height=\'100%\' fill=\'hsla(240,6.7%,17.6%,1)\'/><path d=\'M100.16 24.75a2.93 2.93 0 11.04 5.86 2.93 2.93 0 01-2.95-2.91 2.92 2.92 0 012.9-2.95zm-100 0a2.93 2.93 0 11.04 5.86 2.93 2.93 0 01-2.95-2.91 2.92 2.92 0 012.9-2.95zm9.57 53.18c1.6 0 2.9 1.3 2.9 2.9a2.95 2.95 0 01-2.95 2.96 2.9 2.9 0 01-2.9-2.9 2.95 2.95 0 012.95-2.96zm58.57-2.51a2.93 2.93 0 11.04 5.86 2.93 2.93 0 11-.04-5.86zM49.45 4.4a2.93 2.93 0 11.04 5.86 2.93 2.93 0 01-.04-5.86zM21.66 49.6l2.95 2.91-2.9 2.95-2.95-2.9zm43.55-12.85s2.9 1.3 2.9 2.9v.05c0 1.6-1.3 2.9-2.9 2.9h-.04c-1.6 0-2.9-2.9-2.9-2.9z\'  stroke-width=\'1\' stroke=\'none\' fill=\'hsla(47,80.9%,61%,1)\'/><path d=\'M89.93 57.48a1.08 1.08 0 01.39-1.38c2.44-1.53 5.04-1.81 7.15-.8 2.1 1.03 3.47 3.26 3.77 6.13.22 2.14 1.14 3.71 2.58 4.42 1.44.7 3.24.45 5.07-.69a1.07 1.07 0 011.13 1.8c-2.44 1.54-5.04 1.83-7.14.81-2.1-1.02-3.48-3.25-3.77-6.12-.23-2.15-1.15-3.72-2.59-4.42-1.44-.7-3.24-.46-5.07.68-.5.32-1.16.16-1.47-.33l-.05-.1zm10.06 31.11a.87.87 0 011.07.46c.99 2.14.95 4.28-.1 5.88-1.05 1.6-3 2.48-5.36 2.42-1.76-.04-3.13.54-3.85 1.63-.72 1.1-.71 2.59.03 4.18a.87.87 0 11-1.59.73c-.99-2.13-.95-4.27.1-5.87 1.05-1.6 3-2.48 5.36-2.42 1.76.04 3.13-.54 3.85-1.63.72-1.1.71-2.59-.03-4.18a.87.87 0 01.52-1.2zm0-100a.87.87 0 011.07.46c.99 2.14.95 4.28-.1 5.88-1.05 1.6-3 2.48-5.36 2.42-1.76-.04-3.13.54-3.85 1.63-.72 1.1-.71 2.59.03 4.18a.87.87 0 11-1.59.73c-.99-2.13-.95-4.27.1-5.87 1.05-1.6 3-2.48 5.36-2.42 1.76.04 3.13-.54 3.85-1.63.72-1.1.71-2.59-.03-4.18a.87.87 0 01.52-1.2zM9.44 9.9c.15-.3.54-.39.9-.24 1.88.82 3.16 2.12 3.53 3.58.38 1.47-.21 2.93-1.6 4.02-1.04.8-1.47 1.81-1.22 2.81.26 1 1.17 1.9 2.57 2.5.39.18.6.58.47.9-.13.34-.55.47-.93.3-1.88-.82-3.16-2.12-3.54-3.58-.37-1.46.22-2.93 1.6-4.01 1.05-.81 1.48-1.82 1.23-2.82-.26-1-1.17-1.89-2.58-2.5-.38-.17-.59-.57-.46-.9l.03-.07zm-19.51 47.59a1.08 1.08 0 01.39-1.38c2.44-1.53 5.04-1.81 7.15-.8 2.1 1.03 3.47 3.26 3.77 6.13.22 2.14 1.14 3.71 2.58 4.42 1.44.7 3.24.45 5.07-.69a1.07 1.07 0 011.13 1.8c-2.44 1.54-5.04 1.83-7.14.81C.78 66.75-.6 64.52-.9 61.65c-.23-2.15-1.15-3.72-2.59-4.42-1.44-.7-3.24-.46-5.07.68-.5.32-1.16.16-1.47-.33l-.05-.1zM-.01 88.59a.87.87 0 011.07.46c.99 2.14.95 4.28-.1 5.88-1.05 1.6-3 2.48-5.36 2.42-1.76-.04-3.13.54-3.85 1.63-.72 1.1-.71 2.59.03 4.18a.87.87 0 11-1.59.73c-.99-2.13-.95-4.27.1-5.87 1.05-1.6 3-2.48 5.36-2.42 1.76.04 3.13-.54 3.85-1.63.72-1.1.71-2.59-.03-4.18a.87.87 0 01.52-1.2zm43.92-4.85c-.24-.48-.1-1.08.36-1.38 2.41-1.59 5-1.93 7.13-.96s3.55 3.17 3.92 6.03c.27 2.14 1.23 3.7 2.68 4.36 1.46.67 3.25.38 5.05-.8a1.07 1.07 0 011.48.3c.32.5.19 1.16-.3 1.48-2.4 1.59-5 1.94-7.13.96-2.12-.97-3.55-3.17-3.91-6.03-.28-2.14-1.23-3.69-2.69-4.36-1.46-.67-3.25-.38-5.05.8-.49.32-1.16.2-1.48-.3l-.06-.1zM41 45.67c-.47.25-1.07.1-1.38-.35-1.61-2.39-2-4.98-1.05-7.11.94-2.14 3.13-3.6 5.98-4 2.14-.3 3.67-1.27 4.32-2.73.65-1.47.34-3.26-.87-5.05-.33-.49-.2-1.15.28-1.48.5-.33 1.15-.2 1.5.28 1.6 2.39 2 4.98 1.04 7.11-.94 2.14-3.12 3.6-5.98 4-2.13.3-3.67 1.27-4.32 2.73-.65 1.47-.34 3.26.87 5.05.33.49.21 1.15-.28 1.49-.04.01-.07.04-.1.06z\'  stroke-width=\'1\' stroke=\'none\' fill=\'hsla(4.1,89.6%,58.4%,1)\'/><path d=\'M101 9.76l.75 1.71-9.97 4.34-.74-1.72zM87.35 9.7l-.66 1.75L59.14 1.12l.65-1.76zM41.4-6.21l1.62.93L34.2 10l-1.62-.94zM87.35 109.7l-.66 1.76-27.55-10.35.65-1.75zM50.58 56.03l1.85-.3 1.83 11.32-1.85.3zm-6.22 13.79l-.5 1.8-17-4.66.5-1.8zM41.4 93.79l1.62.93L34.2 110l-1.62-.94zM87.35 9.7l-.66 1.75L59.14 1.12l.65-1.76zm-7.77 42.56l.77 1.76-16.34 7.11-.77-1.75zM1 9.76l.75 1.71-9.96 4.34-.75-1.72zm100 0l.75 1.71-9.97 4.34-.74-1.72zM31.04 27.68l.6 1.86-23.13 7.48-.6-1.86zm48.1 46.45l.73-1.72 10 4.28-.74 1.72zM41.4-6.2l1.62.93L34.2 10l-1.62-.94zM67.54 11.2l1.62.94-7.26 12.57-1.62-.94zM21.22 90.35l-.6-1.4 9.58-4.16.6 1.39zm69.3-49.79l-1.5 1.12L78.5 27.55l1.5-1.12zm-3.17 69.14l-.66 1.76-27.55-10.35.65-1.75zM41.4 93.8l1.62.93L34.2 110l-1.62-.94zM1 9.76l.74 1.71-9.96 4.34-.75-1.72z\'  stroke-width=\'1\' stroke=\'none\' fill=\'hsla(186.8,100%,41.6%,1)\'/></pattern></defs><rect width=\'800%\' height=\'800%\' transform=\'translate(0,0)\' fill=\'url(%23memphis-2-pattern)\'/></svg>");background-size: cover;}

					#hexmap5 .hex path { stroke: #656058; stroke-width: 3px; color: inherit; }
					#hexmap5 .hex-label { font-size: 0.8em; }
					#hexmap5 .data-layer .hex path { fill: #efefef; }
					#hexmap5 .data-layer .hex.hover path { fill: #dddddd; }

					/*
					  We can apply a fill with a custom "swirl-pattern" - to a <path> in a hex with class "swirls".
					  We will need to make sure that the pattern is added when setting up the hexmap
					*/
					#hexmap5 .data-layer .swirls path { fill: url(#swirl-pattern)!important; }
					</style>
					<figure>
						<div id="hexmap5"></div>
						<figcaption>Example with images in hexes. Patterns courtesy of <a href="https://pattern.monster/memphis-2">Pattern Monster</a>.</figcaption>
					</figure>
					<script>
					OI.ready(function(){
						hex = new OI.hexmap(document.getElementById('hexmap5'),{
							// The HexJSON layout
							'hexjson': {
								"layout":"odd-q",
								"hexes": {
									"A":{"n":"1a","q":0,"r":3,"label":"Hornsey"},
									"B":{"n":"2a","q":1,"r":2,"label":"Hackney"},
									"C":{"n":"3a","q":2,"r":2,"label":"OldFord"},
									"D":{"n":"4a","q":2,"r":1,"label":"Poplar"},
									"E":{"n":"5a","q":2,"r":0,"label":"Deptford"},
									"F":{"n":"6a","q":1,"r":-1,"label":"Peckham"},
									"G":{"n":"7a","q":0,"r":-1,"label":"Brixton"},
									"H":{"n":"8a","q":-1,"r":-1,"label":"Battersea"},
									"I":{"n":"9a","q":-2,"r":0,"label":"Chelsea"},
									"J":{"n":"10a","q":-2,"r":1,"label":"Mary LeBone"},
									"K":{"n":"11a","q":-2,"r":2,"label":"St John's Wood"},
									"L":{"n":"12a","q":-1,"r":2,"label":"KentishTown"},
									"M":{"n":"1","q":0,"r":2,"label":"Islington"},
									"N":{"n":"2","q":1,"r":1,"label":"Bethnal Green"},
									"O":{"n":"3","q":1,"r":0,"label":"Southwark"},
									"P":{"n":"4","q":0,"r":0,"label":"Kennington"},
									"Q":{"n":"5","q":-1,"r":0,"label":"Westminster"},
									"R":{"n":"6","q":-1,"r":1,"label":"St Pancras"},
									"S":{"n":"","q":0,"r":1,"label":"The City","class":"swirls"}
								}
							},
							'patterns': [
								'<pattern id="swirl-pattern" height="100%" width="100%" patternUnits="objectBoundingBox"><image href="data:image/svg+xml,<svg id=\'waves-7\' width=\'100%\' height=\'100%\' xmlns=\'http://www.w3.org/2000/svg\'><defs><pattern id=\'waves-7-pattern\' patternUnits=\'userSpaceOnUse\' width=\'35.584\' height=\'30.585\' patternTransform=\'scale(2) rotate(0)\'><rect x=\'0\' y=\'0\' width=\'100%\' height=\'100%\' fill=\'wheat\'/><path d=\'M36.908 9.243c-5.014 0-7.266 3.575-7.266 7.117 0 3.376 2.45 5.726 5.959 5.726 1.307 0 2.45-.463 3.244-1.307.744-.811 1.125-1.903 1.042-3.095-.066-.811-.546-1.655-1.274-2.185-.596-.447-1.639-.894-3.162-.546-.48.1-.778.58-.662 1.06.1.48.58.777 1.06.661.695-.149 1.274-.066 1.705.249.364.265.546.645.562.893.05.679-.165 1.308-.579 1.755-.446.48-1.125.744-1.936.744-2.55 0-4.188-1.538-4.188-3.938 0-2.466 1.44-5.347 5.495-5.347 2.897 0 6.008 1.888 6.388 6.058.166 1.804.067 5.147-2.598 7.034a.868.868 0 00-.142.122c-1.311.783-2.87 1.301-4.972 1.301-4.088 0-6.123-1.952-8.275-4.021-2.317-2.218-4.7-4.518-9.517-4.518-4.094 0-6.439 1.676-8.479 3.545.227-1.102.289-2.307.17-3.596-.496-5.263-4.567-7.662-8.159-7.662-5.015 0-7.265 3.574-7.265 7.116 0 3.377 2.45 5.727 5.958 5.727 1.307 0 2.449-.463 3.243-1.308.745-.81 1.126-1.903 1.043-3.095-.066-.81-.546-1.654-1.274-2.184-.596-.447-1.639-.894-3.161-.546-.48.1-.778.58-.662 1.06.099.48.579.777 1.059.66.695-.148 1.275-.065 1.705.25.364.264.546.645.563.893.05.679-.166 1.307-.58 1.754-.447.48-1.125.745-1.936.745-2.549 0-4.188-1.539-4.188-3.939 0-2.466 1.44-5.345 5.495-5.345 2.897 0 6.008 1.87 6.389 6.057.163 1.781.064 5.06-2.504 6.96-1.36.864-2.978 1.447-5.209 1.447-4.088 0-6.124-1.952-8.275-4.021-2.317-2.218-4.7-4.518-9.516-4.518v1.787c4.088 0 6.123 1.953 8.275 4.022 2.317 2.218 4.7 4.518 9.516 4.518 4.8 0 7.2-2.3 9.517-4.518 2.151-2.069 4.187-4.022 8.275-4.022s6.124 1.953 8.275 4.022c2.318 2.218 4.701 4.518 9.517 4.518 4.8 0 7.2-2.3 9.516-4.518 2.152-2.069 4.188-4.022 8.276-4.022s6.123 1.953 8.275 4.022c2.317 2.218 4.7 4.518 9.517 4.518v-1.788c-4.088 0-6.124-1.952-8.275-4.021-2.318-2.218-4.701-4.518-9.517-4.518-4.103 0-6.45 1.683-8.492 3.556.237-1.118.304-2.343.184-3.656-.497-5.263-4.568-7.663-8.16-7.663z\'  stroke-width=\'1\' stroke=\'none\' fill=\'hsla(47,80.9%,61%,1)\'/><path d=\'M23.42 41.086a.896.896 0 01-.729-.38.883.883 0 01.215-1.242c2.665-1.887 2.764-5.23 2.599-7.034-.38-4.187-3.492-6.058-6.389-6.058-4.055 0-5.495 2.88-5.495 5.346 0 2.4 1.639 3.94 4.188 3.94.81 0 1.49-.265 1.936-.745.414-.447.63-1.076.58-1.755-.017-.248-.2-.629-.547-.893-.43-.315-1.026-.398-1.704-.249a.868.868 0 01-1.06-.662.868.868 0 01.662-1.059c1.523-.348 2.566.1 3.161.546.729.53 1.209 1.374 1.275 2.185.083 1.191-.298 2.284-1.043 3.095-.794.844-1.936 1.307-3.244 1.307-3.508 0-5.958-2.35-5.958-5.726 0-3.542 2.25-7.117 7.266-7.117 3.591 0 7.663 2.4 8.16 7.663.347 3.79-.828 6.868-3.344 8.656a.824.824 0 01-.53.182zm0-30.585a.896.896 0 01-.729-.38.883.883 0 01.215-1.242c2.665-1.887 2.764-5.23 2.599-7.034-.381-4.187-3.493-6.058-6.389-6.058-4.055 0-5.495 2.88-5.495 5.346 0 2.4 1.639 3.94 4.188 3.94.81 0 1.49-.266 1.936-.746.414-.446.629-1.075.58-1.754-.017-.248-.2-.629-.547-.894-.43-.314-1.026-.397-1.705-.248A.868.868 0 0117.014.77a.868.868 0 01.662-1.06c1.523-.347 2.566.1 3.161.547.729.53 1.209 1.374 1.275 2.185.083 1.191-.298 2.284-1.043 3.095-.794.844-1.936 1.307-3.244 1.307-3.508 0-5.958-2.35-5.958-5.726 0-3.542 2.25-7.117 7.266-7.117 3.591 0 7.663 2.4 8.16 7.663.347 3.79-.828 6.868-3.344 8.656a.824.824 0 01-.53.182zm29.956 1.572c-4.8 0-7.2-2.3-9.517-4.518-2.151-2.069-4.187-4.022-8.275-4.022S29.46 5.486 27.31 7.555c-2.317 2.218-4.7 4.518-9.517 4.518-4.8 0-7.2-2.3-9.516-4.518C6.124 5.486 4.088 3.533 0 3.533s-6.124 1.953-8.275 4.022c-2.317 2.218-4.7 4.518-9.517 4.518-4.8 0-7.2-2.3-9.516-4.518-2.152-2.069-4.188-4.022-8.276-4.022V1.746c4.8 0 7.2 2.3 9.517 4.518 2.152 2.069 4.187 4.022 8.275 4.022s6.124-1.953 8.276-4.022C-7.2 4.046-4.816 1.746 0 1.746c4.8 0 7.2 2.3 9.517 4.518 2.151 2.069 4.187 4.022 8.275 4.022s6.124-1.953 8.275-4.022c2.318-2.218 4.7-4.518 9.517-4.518 4.8 0 7.2 2.3 9.517 4.518 2.151 2.069 4.187 4.022 8.275 4.022s6.124-1.953 8.275-4.022c2.317-2.218 4.7-4.518 9.517-4.518v1.787c-4.088 0-6.124 1.953-8.275 4.022-2.317 2.234-4.717 4.518-9.517 4.518z\'  stroke-width=\'1\' stroke=\'none\' fill=\'hsla(4.1,89.6%,58.4%,1)\'/></pattern></defs><rect width=\'800%\' height=\'800%\' transform=\'translate(0,0)\' fill=\'url(%23waves-7-pattern)\'/></svg>" x="0" y="0" width="25%" preserveAspectRatio="xMidYMid meet"></image></pattern>',
							],
							'label': {
								'show': true,
								'format': function(txt,attr){
									return '<tspan>'+attr.hex.label+'</tspan>';
								}
							}
						});
					});
					</script>
				</div>
			</section>
		</div>
	</div>
	<footer>
		<div class="holder">
		<p>&copy; 2022-2024 <a href="https://open-innovations.org/" target="_parent">Open Innovations</a> (<a href="https://creativecommons.org/licenses/by/4.0/" target="_parent">CC BY</a>). Find the <a href="https://github.com/open-innovations/oi.hexmap.js">code on Github</a>.</p>
		</div>
	</footer>
	<script src="resources/oi.formatexamples.js"></script>
	<script src="https://open-innovations.org/resources/oi.log.js"></script>
	<script>
	OI.log.setup({'id':'odileeds','target':['open-innovations.github.io','open-innovations.org']}).add('action=view');
	</script>
</body>
</html>